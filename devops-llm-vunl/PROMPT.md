# LLM 프롬프트 템플릿

아래 템플릿을 Vision-LLM API 호출 시 그대로 사용하세요:

## 기본 프롬프트

```
아래 웹 취약점 진단 이미지를 분석해,
• id: 취약점 고유번호
• type: 취약점 유형
• incidents: 유사 해킹 사고 사례 2건(사례명, 날짜, 요약)
• risk: 해킹 시 예상 피해 시나리오
• management: 위험 수준별(urgent/short_term/long_term) 대책 제안
• metacognition: 메타인지 교육 필요성 및 주제
를 JSON 배열로 반환해줘.
```

## JSON 응답 스키마

```json
[
  {
    "id": "string",
    "type": "string",
    "incidents": [
      { 
        "title": "string", 
        "date": "YYYY-MM-DD", 
        "summary": "string" 
      },
      { 
        "title": "string", 
        "date": "YYYY-MM-DD", 
        "summary": "string" 
      }
    ],
    "risk": "string",
    "management": {
      "urgent": "string",
      "short_term": "string",
      "long_term": "string"
    },
    "metacognition": "string"
  }
]
```

## 필드 설명

### id
- **설명**: 취약점의 고유 식별자
- **형식**: 문자열 (예: "VULN-001", "VULN-002")
- **예시**: "VULN-001"

### type
- **설명**: 취약점의 유형
- **형식**: 문자열
- **예시**: "SQL Injection", "Cross-Site Scripting", "Authentication Bypass"

### incidents
- **설명**: 유사한 해킹 사고 사례 2건
- **형식**: 객체 배열
- **필수 필드**:
  - `title`: 사고 사례명
  - `date`: 발생 날짜 (YYYY-MM-DD 형식)
  - `summary`: 사고 요약

### risk
- **설명**: 해당 취약점으로 인한 예상 피해 시나리오
- **형식**: 문자열
- **포함 내용**: 공격 방법, 예상 피해, 영향 범위

### management
- **설명**: 위험 수준별 대응 방안
- **형식**: 객체
- **필수 필드**:
  - `urgent`: 즉시 대응 방안 (긴급 조치)
  - `short_term`: 단기 대응 방안 (1-3개월)
  - `long_term`: 중장기 대응 방안 (3개월 이상)

### metacognition
- **설명**: 메타인지 교육의 필요성 및 주제
- **형식**: 문자열
- **포함 내용**: 교육 필요성, 구체적인 교육 주제, 학습 목표

## 사용 예시

### 입력 이미지
웹 취약점 진단 도구의 스캔 결과 이미지

### 예상 출력
```json
[
  {
    "id": "VULN-001",
    "type": "SQL Injection",
    "incidents": [
      {
        "title": "A사 개인정보 유출 사고",
        "date": "2023-01-15",
        "summary": "SQL Injection 취약점을 악용하여 고객의 이름, 주민등록번호, 계좌번호 등의 개인정보가 유출되었다. 취약한 로그인 페이지의 입력값 검증 부족이 주요 원인으로 지목되었다."
      },
      {
        "title": "B쇼핑몰 데이터베이스 침해",
        "date": "2022-10-28",
        "summary": "SQL Injection 공격으로 B쇼핑몰의 데이터베이스에 접근하여 고객 계정 정보를 탈취하고, 이를 이용하여 금전적 피해를 입혔다. 데이터베이스 에러 메시지 노출로 인해 공격자가 공격을 용이하게 수행할 수 있었다."
      }
    ],
    "risk": "SQL Injection 취약점은 공격자가 데이터베이스에 직접 접근하여 데이터를 수정, 삭제, 혹은 탈취할 수 있게 합니다. /login.php 페이지의 취약점은 사용자 계정 정보, 개인 정보, 금융 정보 등 중요한 데이터 유출로 이어질 수 있으며, 서비스 중단 및 금전적 손실, 평판 손상 등 심각한 피해를 초래할 수 있습니다. 특히, 데이터베이스 에러 메시지 노출은 공격자에게 추가적인 정보를 제공하여 공격을 용이하게 만듭니다.",
    "management": {
      "urgent": "임시 방편으로 /login.php 페이지 접근을 차단하고, 사용자들에게 비밀번호 변경을 권고합니다. 긴급한 보안 패치를 준비합니다.",
      "short_term": "입력값 검증을 강화하고, 준비된 명령문(Prepared Statements)을 사용하여 SQL Injection 공격을 방지합니다. 데이터베이스 에러 메시지를 숨기는 등의 조치를 취합니다. 취약점 수정 후, 침입 탐지 시스템(IDS) 및 침입 방지 시스템(IPS)을 통해 지속적인 모니터링을 실시합니다.",
      "long_term": "정기적인 취약점 점검 및 보안 교육을 실시하여 유사한 취약점 발생을 예방합니다. 안전한 코딩 가이드라인을 마련하고, 개발자 교육을 통해 안전한 웹 애플리케이션 개발을 장려합니다. 보안 감사를 정기적으로 수행하여 보안 체계의 효율성을 높입니다."
    },
    "metacognition": "개발자 및 보안 담당자는 자신의 코드에 대한 이해도를 높이고, SQL Injection과 같은 취약점의 원인과 영향을 정확히 파악해야 합니다. 메타인지 교육을 통해 자기 성찰 능력을 향상시켜, 취약점을 사전에 예방하고, 발생 시 신속하고 효과적으로 대응할 수 있도록 해야 합니다. 교육 주제는 다음과 같습니다: \n- SQL Injection 취약점의 원리와 공격 기법\n- 안전한 입력값 검증 방법\n- 준비된 명령문(Prepared Statements)의 사용\n- 에러메시지 처리 및 로그 관리\n- 보안 코딩 가이드라인 및 모범 사례"
  }
]
```

## 프롬프트 최적화 팁

1. **명확한 지시**: 각 필드가 무엇을 의미하는지 명확히 설명
2. **구체적인 형식**: 날짜 형식, ID 형식 등을 구체적으로 지정
3. **예시 포함**: 실제 사고 사례나 대응 방안의 예시 제공
4. **일관성 유지**: 모든 취약점에 대해 동일한 구조의 응답 요구
5. **PMT 기반**: 보호동기 이론의 구성요소를 반영한 분석 요구

## 오류 처리

- **이미지 인식 실패**: "이미지를 분석할 수 없습니다" 메시지 반환
- **취약점 미발견**: 빈 배열 반환
- **부분적 분석**: 가능한 정보만 포함하여 응답
- **JSON 파싱 오류**: 텍스트 형태로 응답 후 후처리 